1. 分布式文件存储数据库MongoDB
   1. MongoDB也是数据库，和mysql的区别如图 ![](./MongoDB与MySQL区别.png)
   2. MongoDB是用c++语言编写的非关系型数据库
   3. net start mongodb 开启服务
   4. net stop mongodb 关闭服务
2. 第三方包mongoose的使用
   1. 安装 npm install mongoose
   2. 使用
      ```
      const mongoose = require('mongoose')

      mongoose.connect('mongodb://localhost/user_test').then(res =>{     // 链接数据库，其中参数分别为mongodb协议、主机名和需要链接的数据库。返回值是promise
        console.log('链接成功')
      }).catch(err =>{
        console.log('链接失败')
      })
      ```
3. MongoDB常用数据库操作
   1. 创建集合、文档
      1. MongoDB不需要显示的创建数据库，如果数据库不存在，会自动创建
      2. 集合相当于一个表，文档相当于表中的数据
         1. 创建集合
            ```
            const schema = new mongoose.Schema(options)  // 创建集合结构（规则）， options集合的结构（规则）
            const Model = mongoose.model(modelName, schema) // modelName集合名称，也就是表名称，schema集合结构
            ```
         2. 创建文档
            ```
            第一种方式
            const doc = new Model(options) // options符合集合规则的文档数据，以对象形式
            doc.save() // 将文档插入到数据库中
            第二种方式
            Model.create(options, (err, doc)) // options符合集合规则的文档数据，以对象形式，err为报错信息，doc是插入的文档
            ```
   2. 导入文件数据到数据库
      1. 数据库导入数据
         1. mongoimport -d 数据库名称 -c 集合名称 --file 导入的数据文件路径
         2. 使用mongoimport命令需要在环境变量添加mongoDB bin 文件夹的路径，并且保证bin文件夹下有mongoimport.exe程序
         3. mongoimport -d user -c users --file ./user.json
   3. 查询文档
      1. 查询文档
        ```
        Model.find({name:'wang', sex:2})  根据调价查询文档，条件为空则查询所有文档  返回数组
        Model.findOne()   默认返回当前集合中的第一条文档  返回对象
        ```
      2. 区间查询
        ```
        {key: {$gt:value, $lt:value}}  gt大于， lt小于，gte大于等于， lte小于等于
        Model.find({age:{$gt:18, $lt:35}}).then(res =>{
          consoel.log(res)
        })
        ```
      3. 模糊查询
        ```
        {key:正则表达式}
        Model.find({city:/上/}).then(res =>{
          consoel.log(res)
        })
        ```
      4. 选择要查询的字段
        ```
        Model.find().select(arg)  arg为要操作的字段 字段前加-表示不查询该字段
        Model.find().select("name city -_id").then()
        ```
      5. 排序
        ```
        Model.find().sort(arg)  arg为要操作的字段 字段前加-表示降序排列
        Model.find().sort("age").then()
        ```
      6. 跳过多少条数据、限制查询数量
        ```
        Model.find().skip(num).limit(num)  skip表示跳过多少条数据，limit限制查询数量
        ```
   4. 更新文档
      1. 更新单个文档
        ```
        更新指定条件文档，如果查询多个文档，则更新第一个匹配文档  返回值为该文档
        Model.findOneAndUpdate(条件，更新的值)
        Model.findOneAndUpdate({name:'2'},{city:'深圳'}).then()
        更新指定条件文档，如果查询多个文档，则更新第一个匹配文档   返回值为ok的对象
        Model.updateOne(条件，更新的值)
        Model.updateOne({name:'2'},{city:'深圳'}).then()

        全局配置
        mongoose.set('useFindAndModify', false)
        ```
      2. 更新多个文档
        ```
        Model.updateMany(条件，更新的值)   如果条件为空，则会更新全部文档
        Model.updateMany({name:'xx'},{city:'深圳'}).then()
        ```
   5. 删除文档
      1. 删除单个文档
        ```
        删除指定条件文档，如果查询多个文档，则删除第一个匹配文档  返回值为该文档
        Model.findOneAndDelete(条件)
        Model.findOneAndDelete({name:'2'}).then()
        删除指定条件文档，如果查询多个文档，则删除第一个匹配文档   返回值为ok的对象
        Model.deleteOne(条件)
        Model.deleteOne({name:'2'}).then()

        ```
      2. 删除多个文档
        ```
        Model.deleteMany(条件)   如果条件为空，则会删除全部文档
        Model.deleteMany({name:'xx'}).then()
        ```
4. mongoDB字段验证
   1. required  验证字段是否为必须输入，值为Boolean
      ```
      const schema = mongoose.Schema
      const userSchema = new schema({
        name: {
          type: String,
          required:true
        },
        name: {
          type: String,
          required:[true, '该字段为必选字段'] // 如果写成数组形式，后面的内容为报错信息，在error.errors.message中。后面的都可以这样自定义报错信息
        },
        city: String,
      })
      ```
   2. minlength，maxlength 验证字符的值的最小长度和最大长度
   3. trim 去除字符串首位空格，值为Boolean
   4. min，max  验证最小最大数字
   5. default 默认值
   6. enum 规定输入的值必须是哪一些
      ```
      name: {
        type: String,
        enum:['wang', 'wen', 'tao']
      },
      name: {
        type: String,
        enum:{
          values:['wang', 'wen', 'tao'],       // 如果写成对象形式，message中的内容为报错信息
          message:'该值不在设定的范围内'   
        }
      },
      ```
   7. validate 根据自定义条件验证，通过validate函数处理输入值，message为自定义错误信息
      ```
      name: {
        type: String,
        validate:{
          validator: v =>{
            // todo 返回Boolean值验证输入值是否有效
          },
          message:'报错信息'
        }
      },
      ```
   8. 通过catch获取errors对象，遍历对象从中获取对应字段自定义报错信息
      ```
      model.create().then().catch(error =>{
        获取错误信息对象
        const errs = error.errors
        循环错误信息对象
        for(let i in errs){
          console.log(errs[i].message)
        }
      })
      ```
   9.  